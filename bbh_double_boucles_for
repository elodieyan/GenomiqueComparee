# -*- coding: utf-8 -*-
"""
Created on Tue Nov 10 15:30:11 2020

@author: Administrator
"""

import sys
import pandas as pd
from io import StringIO
#pip install progressbar2
from progressbar import ProgressBar


#faudra voir comment on séléctionne les deux bons fichiers automatiquement
name_1 = 'Escherichia_coli_536-vs-Escherichia_coli_55989.csv'
name_2 = 'Escherichia_coli_55989-vs-Escherichia_coli_536.csv'
file_1 = pd.read_csv(name_1) #colonne 1 : 536, colonne 2 : 55989
file_2 = pd.read_csv(name_2) #colonne 1 : 55989, colonne 2 : 536


#faudra changer les noms des colonnes en fonction des noms des bactérie, ici 536 puis 55989
#on est obligé de mettre le même nom de colonne que pour les file sinon on peut pas copier coller les lignes
file_BBH = pd.DataFrame(columns = ['query id','subject id','% identity','evalue','% couverture'])

#on veut vérif
for i in range (0,len(file_1.index)):
    #on parcourt les lignes du premier fichier,
    #on va regarder pour chaque ligne quel gène est dans la deuxième colonne 
    #puis on va voir dans le deuxième fichier si pour ce gène la dans la permière colonne 
    #le gène dans la deuxième est celui dans la première du fichier 1
    
    
    #faudrait rajouter condition pour supprimer ligne une fois qu'uiliser dans file_2 sinon il fait tout deux fois et c'est con
    for j in range (0,len(file_2.index)):
        #on parcourt les lignes du deuxième fichier
        if file_1.loc[file_1.index[i],'subject id'] == file_2.loc[file_2.index[j],'query id'] and file_1.loc[file_1.index[i],'query id'] == file_2.loc[file_2.index[i],'subject id']:
            file_BBH.loc[len(file_BBH.index)] = file_1.loc[i,:].values

        

    
